---
layout: default
title: "Gallery"
permalink: /gallery/
author_profile: false
---

<style>
    :root {
        --accent1: #364f6b;
        --muted: #64748b;
        --muted-200: #e2e8f0;
        --card-radius: .85rem;
        --card-shadow: 0 3px 10px rgba(0, 0, 0, .05);
        --card-shadow-hover: 0 5px 14px rgba(0, 0, 0, .12);
    }

    .gallery-wrap {
        max-width: 1080px;
        margin: 0 auto;
        padding: 0 1.5rem 4.5rem;
    }

    .gallery-hero {
        margin: .25rem 0 1rem;
        text-align: center;
    }

    .gallery-hero h1 {
        margin: 0 0 .35rem;
        color: var(--accent1);
        font-size: 1.8rem;
        letter-spacing: .2px;
    }

    .gallery-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.1rem;
    }

    @media (min-width:768px) {
        .gallery-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    .gallery-card {
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: var(--card-radius);
        box-shadow: var(--card-shadow);
        overflow: hidden;
        transition: transform .2s, box-shadow .2s;
    }

    .gallery-card:hover {
        transform: translateY(-3px);
        box-shadow: var(--card-shadow-hover);
    }

    /* Navy title bar */
    .gallery-header {
        background-color: var(--accent1);
        color: #fff;
        padding: 0.6rem 1rem;
        font-size: 1rem;
        font-weight: 700;
    }

    .gallery-media {
        position: relative;
        background: linear-gradient(180deg, #f8fafc, #eef2f7);
        display: flex;
        align-items: center;
        justify-content: center;
        width: 80%;
        margin: 0 auto;
    }

    .gallery-media img {
        width: 100%;
        height: auto;
        object-fit: contain;
        display: block;
    }

    .gallery-body {
        padding: .85rem 1rem .75rem;
    }

    .gallery-summary {
        margin: .2rem 0 .5rem;
        color: #42536a;
        font-size: .92rem;
        line-height: 1.4;
    }

    .gallery-full {
        margin: .25rem 0 .5rem;
        color: #334155;
        font-size: .92rem;
        line-height: 1.5;
    }

    /* Meta line styling */
    .gallery-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.75rem;
        flex-wrap: wrap;
        margin-top: 0.75rem;
    }

    .gallery-meta-left {
        display: flex;
        align-items: center;
        gap: 0.6rem;
        flex-wrap: wrap;
    }

    .posted-pill {
        padding: .25rem .55rem;
        border: 1px solid var(--muted-200);
        border-radius: 999px;
        background: #fff;
        font-size: .82rem;
        color: #475569;
    }

    .gallery-date {
        font-size: 0.82rem;
        color: var(--muted);
    }

    .expand-btn {
        appearance: none;
        border: 1px solid var(--muted-200);
        background: #f9fafb;
        border-radius: 999px;
        padding: .35rem .9rem;
        font-size: .8rem;
        cursor: pointer;
        transition: background 0.2s ease, box-shadow 0.2s ease;
    }

    .expand-btn:hover {
        background: #f1f5f9;
        box-shadow: 0 2px 6px rgba(0, 0, 0, .08);
    }
</style>

<div class="gallery-wrap">
    <div class="gallery-hero">
        <h1>MPSG Gallery</h1>
    </div>

    {%- assign has_gallery = site.gallery | size -%}
    {%- if has_gallery > 0 -%}
    {%- assign items = site.gallery -%}
    {%- else -%}
    {%- assign items = site.posts | where_exp: "p", "p.category == 'gallery' or p.categories contains 'gallery'" -%}
    {%- endif -%}

    <div id="gallery-grid" class="gallery-grid">
        {%- assign sorted = items | sort: 'date' | reverse -%}
        {%- for post in sorted -%}
        {%- assign y = post.date | date: '%Y' -%}
        {%- assign date_str = post.date | date: '%b %d, %Y' -%}

        {%- if post.authors -%}
        {%- assign authors_list = post.authors -%}
        {%- elsif post.author -%}
        {%- assign authors_str = post.author -%}
        {%- assign authors_list = authors_str | split: '|' -%}
        {%- if authors_list.size == 1 -%}{%- assign authors_list = authors_str | split: ',' -%}{%- endif -%}
        {%- elsif site.author and site.author.name -%}
        {%- assign authors_list = site.author.name | split: '|' -%}
        {%- else -%}
        {%- assign authors_list = 'Lab' | split: '|' -%}
        {%- endif -%}
        {%- assign posted_by = '' -%}
        {%- assign authors_lc = '' -%}
        {%- for a in authors_list -%}
        {%- assign a_trim = a | strip -%}
        {%- assign a_lc = a_trim | downcase -%}
        {%- if forloop.first -%}
        {%- assign posted_by = a_trim -%}
        {%- assign authors_lc = a_lc -%}
        {%- else -%}
        {%- assign posted_by = posted_by | append: ', ' | append: a_trim -%}
        {%- assign authors_lc = authors_lc | append: '|' | append: a_lc -%}
        {%- endif -%}
        {%- endfor -%}

        {%- assign folder_rel = post.path | replace: 'text.md', '' | downcase -%}
        {%- assign folder_abs = '/' | append: folder_rel -%}
        {%- assign imgs_concat = '' -%}
        {%- for f in site.static_files -%}
        {%- assign fp = f.path | downcase -%}
        {%- if fp contains folder_rel or fp contains folder_abs -%}
        {%- if fp contains '.png' or fp contains '.jpg' or fp contains '.jpeg' or fp contains '.webp' or fp contains
        '.gif' -%}
        {%- if imgs_concat == '' -%}
        {%- assign imgs_concat = f.path -%}
        {%- else -%}
        {%- assign imgs_concat = imgs_concat | append: '|' | append: f.path -%}
        {%- endif -%}
        {%- endif -%}
        {%- endif -%}
        {%- endfor -%}
        {%- assign imgs = imgs_concat | split: '|' | uniq | sort_natural -%}

        {%- assign cover_img = '' -%}
        {%- if imgs.size > 0 -%}
        {%- assign preferred = '' -%}
        {%- for p in imgs -%}
        {%- assign pl = p | downcase -%}
        {%- if pl contains 'cover' or pl contains 'hero' -%}
        {%- assign preferred = p -%}
        {%- break -%}
        {%- endif -%}
        {%- endfor -%}
        {%- assign cover_img = preferred | default: imgs[0] -%}
        {%- endif -%}

        <article class="gallery-card" data-year="{{ y }}" data-authors="{{ authors_lc }}">
            <div class="gallery-header">{{ post.title }}</div>
            {%- if cover_img != nil and cover_img != '' -%}
            <div class="gallery-media">
                <img src="{{ cover_img | relative_url }}" alt="{{ post.title | escape }}" loading="lazy">
            </div>
            {%- endif -%}

            <div class="gallery-body">
                <p class="gallery-summary">
                    {%- if post.summary -%}
                    {{ post.summary }}
                    {%- elsif post.excerpt -%}
                    {{ post.excerpt | strip_html | truncate: 180 }}
                    {%- else -%}
                    {{ post.content | strip_html | truncate: 180 }}
                    {%- endif -%}
                </p>
                <div class="gallery-full" hidden>
                    {{ post.content }}
                </div>

                <!-- Combined meta + button -->
                <div class="gallery-meta">
                    <div class="gallery-meta-left">
                        <span class="posted-pill">Posted by {{ posted_by }}</span>
                        <span class="gallery-date">{{ date_str }}</span>
                    </div>
                    <button class="expand-btn" type="button">Read more</button>
                </div>
            </div>

            {%- if imgs.size > 1 -%}
            <div class="thumbs" aria-label="More images">
                {%- assign shown = 0 -%}
                {%- for img in imgs -%}
                {%- if img != cover_img and shown < 4 -%} <img src="{{ img | relative_url }}"
                    alt="{{ post.title | escape }} extra image" loading="lazy">
                    {%- assign shown = shown | plus: 1 -%}
                    {%- endif -%}
                    {%- endfor -%}
            </div>
            {%- endif -%}
        </article>
        {%- endfor -%}
    </div>
</div>

<script>
    (function () {
        document.addEventListener('click', (e) => {
            const btn = e.target.closest('.expand-btn');
            if (!btn) return;
            const card = btn.closest('.gallery-card');
            const full = card.querySelector('.gallery-full');
            const summary = card.querySelector('.gallery-summary');
            if (!full) return;
            const open = !full.hasAttribute('hidden');
            if (open) {
                full.setAttribute('hidden', '');
                if (summary) summary.style.display = '';
                btn.textContent = 'Read more';
                btn.setAttribute('aria-expanded', 'false');
            } else {
                full.removeAttribute('hidden');
                if (summary) summary.style.display = 'none';
                btn.textContent = 'Show less';
                btn.setAttribute('aria-expanded', 'true');
            }
        });
    })();
</script>